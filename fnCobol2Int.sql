SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create FUNCTION [dbo].[fnCobol2Int]
(@Item VARCHAR(18))
RETURNS VARCHAR(18)
AS

BEGIN
RETURN

CASE WHEN SubString(@Item,LEN(@Item),1) In('}','J','K','L','M','N','O','P','Q','R') THEN
  0-CAST(LEFT(@Item, LEN(@Item) - 1) + CHAR(47 + CHARINDEX(RIGHT(@Item, 1), '}JKLMNOPQR') ) AS VARCHAR(18))
ELSE
  CAST(LEFT(@Item, LEN(@Item) - 1) + CHAR(47 + CHARINDEX(RIGHT(@Item, 1), '{ABCDEFGHI0123456789') ) AS VARCHAR(18))
END 

END
